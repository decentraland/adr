<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="1282" height="332" xmlns="http://www.w3.org/2000/svg" x-original-source="participant ci
participant SNS (global and public) as sns
participant SQS (one per deployment) as sqs
participant EC2 (one per deployment) as ec2
ci->sns: new version published (using aws cli)
sns->sqs: aws.sns.TopicSubscription
ec2->ec2: cron (aws sqs receive-message)
sqs-->ec2: message
ec2->ec2: ./init.sh
ec2-->sqs: delete-message (if succeed)"><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><rect x="10" y="10" width="37" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="33" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="20" y="33">ci</tspan></text><rect x="10" y="267" width="37" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="290" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="20" y="290">ci</tspan></text><line x1="28" x2="28" y1="45" y2="267" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><rect x="254" y="10" width="214" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="264" y="35" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="264" y="35">SNS (global and public)</tspan></text><rect x="254" y="267" width="214" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="264" y="292" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="264" y="292">SNS (global and public)</tspan></text><line x1="361" x2="361" y1="45" y2="267" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><rect x="488" y="10" width="223" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="498" y="35" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="498" y="35">SQS (one per deployment)</tspan></text><rect x="488" y="267" width="223" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="498" y="292" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="498" y="292">SQS (one per deployment)</tspan></text><line x1="599" x2="599" y1="45" y2="267" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><rect x="736" y="10" width="223" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="746" y="35" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="746" y="35">EC2 (one per deployment)</tspan></text><rect x="736" y="267" width="223" height="35" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="746" y="292" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="746" y="292">EC2 (one per deployment)</tspan></text><line x1="847" x2="847" y1="45" y2="267" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><text x="38" y="80" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="38" y="80">new version published (using aws cli)</tspan></text><line x1="28" x2="361" y1="85" y2="85" style="stroke-width: 2px;" stroke="#000000" fill="none" marker-end="url(#markerArrowBlock)"></line><text x="374" y="114" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="374" y="114">aws.sns.TopicSubscription</tspan></text><line x1="361" x2="599" y1="119" y2="119" style="stroke-width: 2px;" stroke="#000000" fill="none" marker-end="url(#markerArrowBlock)"></line><line x1="847" x2="867" y1="134" y2="134" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="867" x2="867" y1="134" y2="154" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="867" x2="847" y1="154" y2="154" style="stroke-width: 2px;" stroke="#000000" fill="none" marker-end="url(#markerArrowBlock)"></line><text x="872" y="151" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="872" y="151">cron (aws sqs receive-message)</tspan></text><text x="693" y="180" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="693" y="180">message</tspan></text><line x1="599" x2="847" y1="185" y2="185" style="stroke-width: 2px;" stroke="#000000" fill="none" stroke-dasharray="6px, 2px" marker-end="url(#markerArrowBlock)"></line><line x1="847" x2="867" y1="200" y2="200" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="867" x2="867" y1="200" y2="217" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="867" x2="847" y1="217" y2="217" style="stroke-width: 2px;" stroke="#000000" fill="none" marker-end="url(#markerArrowBlock)"></line><text x="872" y="214" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="872" y="214">./init.sh</tspan></text><text x="609" y="247" style="font: 14px Menlo, Monaco, &quot;Courier New&quot;, monospace;" text-anchor="start"><tspan x="609" y="247">delete-message (if succeed)</tspan></text><line x1="847" x2="599" y1="252" y2="252" style="stroke-width: 2px;" stroke="#000000" fill="none" stroke-dasharray="6px, 2px" marker-end="url(#markerArrowBlock)"></line></svg>